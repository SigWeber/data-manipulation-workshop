<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Basic Operations | Data manipulation in R (online workshop)</title>
  <meta name="description" content="4 Basic Operations | Data manipulation in R (online workshop)" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Basic Operations | Data manipulation in R (online workshop)" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Basic Operations | Data manipulation in R (online workshop)" />
  
  
  

<meta name="author" content="Sigrid Weber" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-started.html"/>
<link rel="next" href="merging-datasets.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>2</b> Resources</a></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting Started</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#prerequisites"><i class="fa fa-check"></i><b>3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started.html"><a href="getting-started.html#software-requirements"><i class="fa fa-check"></i><b>3.2</b> Software Requirements</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="getting-started.html"><a href="getting-started.html#r-and-rstudio"><i class="fa fa-check"></i><b>3.2.1</b> R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="getting-started.html"><a href="getting-started.html#required-packages"><i class="fa fa-check"></i><b>3.3</b> Required Packages</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="getting-started.html"><a href="getting-started.html#option-1-use-tidyverse"><i class="fa fa-check"></i><b>3.3.1</b> Option 1: Use <code>tidyverse</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="getting-started.html"><a href="getting-started.html#option-2-install-individual-packages"><i class="fa fa-check"></i><b>3.3.2</b> Option 2: Install Individual Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>4</b> Basic Operations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-operations.html"><a href="basic-operations.html#data-pipelines"><i class="fa fa-check"></i><b>4.1</b> Data pipelines</a></li>
<li class="chapter" data-level="4.2" data-path="basic-operations.html"><a href="basic-operations.html#dataset"><i class="fa fa-check"></i><b>4.2</b> Dataset</a></li>
<li class="chapter" data-level="4.3" data-path="basic-operations.html"><a href="basic-operations.html#select"><i class="fa fa-check"></i><b>4.3</b> Select</a></li>
<li class="chapter" data-level="4.4" data-path="basic-operations.html"><a href="basic-operations.html#filter"><i class="fa fa-check"></i><b>4.4</b> Filter</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise"><i class="fa fa-check"></i><b>4.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="basic-operations.html"><a href="basic-operations.html#arrange"><i class="fa fa-check"></i><b>4.5</b> Arrange</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-1"><i class="fa fa-check"></i><b>4.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="basic-operations.html"><a href="basic-operations.html#mutate"><i class="fa fa-check"></i><b>4.6</b> Mutate</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-2"><i class="fa fa-check"></i><b>4.6.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="basic-operations.html"><a href="basic-operations.html#summarise"><i class="fa fa-check"></i><b>4.7</b> Summarise</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-3"><i class="fa fa-check"></i><b>4.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="basic-operations.html"><a href="basic-operations.html#unite"><i class="fa fa-check"></i><b>4.8</b> Unite</a></li>
<li class="chapter" data-level="4.9" data-path="basic-operations.html"><a href="basic-operations.html#separate"><i class="fa fa-check"></i><b>4.9</b> Separate</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-4"><i class="fa fa-check"></i><b>4.9.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="merging-datasets.html"><a href="merging-datasets.html"><i class="fa fa-check"></i><b>5</b> Merging Datasets</a>
<ul>
<li class="chapter" data-level="5.1" data-path="merging-datasets.html"><a href="merging-datasets.html#left-join"><i class="fa fa-check"></i><b>5.1</b> Left Join</a></li>
<li class="chapter" data-level="5.2" data-path="merging-datasets.html"><a href="merging-datasets.html#right-join"><i class="fa fa-check"></i><b>5.2</b> Right Join</a></li>
<li class="chapter" data-level="5.3" data-path="merging-datasets.html"><a href="merging-datasets.html#inner-join"><i class="fa fa-check"></i><b>5.3</b> Inner Join</a></li>
<li class="chapter" data-level="5.4" data-path="merging-datasets.html"><a href="merging-datasets.html#full-join"><i class="fa fa-check"></i><b>5.4</b> Full Join</a></li>
<li class="chapter" data-level="5.5" data-path="merging-datasets.html"><a href="merging-datasets.html#different-column-names"><i class="fa fa-check"></i><b>5.5</b> Different Column Names</a></li>
<li class="chapter" data-level="5.6" data-path="merging-datasets.html"><a href="merging-datasets.html#exercise-5"><i class="fa fa-check"></i><b>5.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i><b>6</b> Reshaping</a></li>
<li class="chapter" data-level="7" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i><b>7</b> Acknowledgments</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data manipulation in R (online workshop)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-operations" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Basic Operations</h1>
<p>Let’s start off by creating a new R script and loading <code>tidyverse</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="basic-operations.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Clear everything to make sure there’s nothing leftover in our environment</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="basic-operations.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div id="data-pipelines" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Data pipelines</h2>
<p>Dplyr makes it easy to “chain” functions together using the <em>pipe</em> operator <code>%&gt;%</code>. The following diagram illustrates the general concept of pipes where data flows from one pipe to another until all the processing is completed.</p>
<p><img src="img/pipes.png" /></p>
<p>The syntax of the pipe operator <code>%&gt;%</code> might appear unusual at first, but once you get used to it you’ll start to appreciate its power and flexibility.</p>
</div>
<div id="dataset" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Dataset</h2>
<p>We’re using a dataset of flight departures from Houston in 2011.</p>
<table>
<thead>
<tr class="header">
<th>Filename</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flights.csv</td>
<td>Flight departures from Houston in 2011</td>
</tr>
<tr class="even">
<td>weather.csv</td>
<td>Hourly weather</td>
</tr>
<tr class="odd">
<td>planes.csv</td>
<td>Metadata for planes</td>
</tr>
<tr class="even">
<td>airports.csv</td>
<td>Metadata for airports</td>
</tr>
</tbody>
</table>
<p>We’re going to use the <code>readr</code> package which provides improved functions for reading datasets from files. Instead of the usual <code>read.csv()</code> function, we’ll use the <code>read_csv()</code> function from <code>readr</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="basic-operations.html#cb11-1" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/SigWeber/data-manipulation-workshop/master/data/flights.csv&quot;</span>)</span></code></pre></div>
<p>Now let’s examine the dataset</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="basic-operations.html#cb12-1" aria-hidden="true" tabindex="-1"></a>flights</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 15
##    date        hour minute   dep   arr dep_delay arr_delay carrier flight origin
##    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; 
##  1 01/01/201~    14      0  1400  1500         0       -10 AA         428 IAH   
##  2 02/01/201~    14      1  1401  1501         1        -9 AA         428 IAH   
##  3 03/01/201~    13     52  1352  1502        -8        -8 AA         428 IAH   
##  4 04/01/201~    14      3  1403  1513         3         3 AA         428 IAH   
##  5 05/01/201~    14      5  1405  1507         5        -3 AA         428 IAH   
##  6 06/01/201~    13     59  1359  1503        -1        -7 AA         428 IAH   
##  7 07/01/201~    13     59  1359  1509        -1        -1 AA         428 IAH   
##  8 08/01/201~    13     55  1355  1454        -5       -16 AA         428 IAH   
##  9 09/01/201~    14     43  1443  1554        43        44 AA         428 IAH   
## 10 10/01/201~    14     43  1443  1553        43        43 AA         428 IAH   
## # ... with 227,486 more rows, and 5 more variables: dest &lt;chr&gt;, plane &lt;chr&gt;,
## #   cancelled &lt;dbl&gt;, time &lt;dbl&gt;, dist &lt;dbl&gt;</code></pre>
<p>Notice that because we used <code>read_csv()</code>, the data frame we received now prints nicely without having to use the <code>head()</code> function and does not clutter your screen.</p>
</div>
<div id="select" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Select</h2>
<p>The <code>select</code> function is used to select columns.</p>
<ul>
<li>Select the destination, duration and distance columns (<code>dest</code>, <code>time</code> and <code>dist</code>)</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="basic-operations.html#cb14-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="basic-operations.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, time, dist)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 3
##    dest   time  dist
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 DFW      40   224
##  2 DFW      45   224
##  3 DFW      48   224
##  4 DFW      39   224
##  5 DFW      44   224
##  6 DFW      45   224
##  7 DFW      43   224
##  8 DFW      40   224
##  9 DFW      41   224
## 10 DFW      45   224
## # ... with 227,486 more rows</code></pre>
<p>Add the arrival delay (<code>arr_delay</code>) and departure delay (<code>dep_delay</code>) columns as well.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="basic-operations.html#cb16-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="basic-operations.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, time, dist, arr_delay, dep_delay)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 5
##    dest   time  dist arr_delay dep_delay
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 DFW      40   224       -10         0
##  2 DFW      45   224        -9         1
##  3 DFW      48   224        -8        -8
##  4 DFW      39   224         3         3
##  5 DFW      44   224        -3         5
##  6 DFW      45   224        -7        -1
##  7 DFW      43   224        -1        -1
##  8 DFW      40   224       -16        -5
##  9 DFW      41   224        44        43
## 10 DFW      45   224        43        43
## # ... with 227,486 more rows</code></pre>
<p>Other ways to do the same</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="basic-operations.html#cb18-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="basic-operations.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, time, dist, <span class="fu">ends_with</span>(<span class="st">&quot;delay&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 5
##    dest   time  dist dep_delay arr_delay
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 DFW      40   224         0       -10
##  2 DFW      45   224         1        -9
##  3 DFW      48   224        -8        -8
##  4 DFW      39   224         3         3
##  5 DFW      44   224         5        -3
##  6 DFW      45   224        -1        -7
##  7 DFW      43   224        -1        -1
##  8 DFW      40   224        -5       -16
##  9 DFW      41   224        43        44
## 10 DFW      45   224        43        43
## # ... with 227,486 more rows</code></pre>
<p>and …</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="basic-operations.html#cb20-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="basic-operations.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, time, dist, <span class="fu">contains</span>(<span class="st">&quot;delay&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 5
##    dest   time  dist dep_delay arr_delay
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 DFW      40   224         0       -10
##  2 DFW      45   224         1        -9
##  3 DFW      48   224        -8        -8
##  4 DFW      39   224         3         3
##  5 DFW      44   224         5        -3
##  6 DFW      45   224        -1        -7
##  7 DFW      43   224        -1        -1
##  8 DFW      40   224        -5       -16
##  9 DFW      41   224        43        44
## 10 DFW      45   224        43        43
## # ... with 227,486 more rows</code></pre>
<p>Select all columns from <code>date</code> to <code>arr</code></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="basic-operations.html#cb22-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="basic-operations.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date<span class="sc">:</span>arr)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 5
##    date              hour minute   dep   arr
##    &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 01/01/2011 12:00    14      0  1400  1500
##  2 02/01/2011 12:00    14      1  1401  1501
##  3 03/01/2011 12:00    13     52  1352  1502
##  4 04/01/2011 12:00    14      3  1403  1513
##  5 05/01/2011 12:00    14      5  1405  1507
##  6 06/01/2011 12:00    13     59  1359  1503
##  7 07/01/2011 12:00    13     59  1359  1509
##  8 08/01/2011 12:00    13     55  1355  1454
##  9 09/01/2011 12:00    14     43  1443  1554
## 10 10/01/2011 12:00    14     43  1443  1553
## # ... with 227,486 more rows</code></pre>
<p>Select all <em>except</em> <code>plane</code> column using the <em>minus</em> sign</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="basic-operations.html#cb24-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="basic-operations.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>plane)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 14
##    date        hour minute   dep   arr dep_delay arr_delay carrier flight origin
##    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; 
##  1 01/01/201~    14      0  1400  1500         0       -10 AA         428 IAH   
##  2 02/01/201~    14      1  1401  1501         1        -9 AA         428 IAH   
##  3 03/01/201~    13     52  1352  1502        -8        -8 AA         428 IAH   
##  4 04/01/201~    14      3  1403  1513         3         3 AA         428 IAH   
##  5 05/01/201~    14      5  1405  1507         5        -3 AA         428 IAH   
##  6 06/01/201~    13     59  1359  1503        -1        -7 AA         428 IAH   
##  7 07/01/201~    13     59  1359  1509        -1        -1 AA         428 IAH   
##  8 08/01/201~    13     55  1355  1454        -5       -16 AA         428 IAH   
##  9 09/01/201~    14     43  1443  1554        43        44 AA         428 IAH   
## 10 10/01/201~    14     43  1443  1553        43        43 AA         428 IAH   
## # ... with 227,486 more rows, and 4 more variables: dest &lt;chr&gt;,
## #   cancelled &lt;dbl&gt;, time &lt;dbl&gt;, dist &lt;dbl&gt;</code></pre>
</div>
<div id="filter" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Filter</h2>
<p>The <code>filter()</code> function returns rows with matching conditions. We can find all flights to Boston (BOS) like this:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="basic-operations.html#cb26-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="basic-operations.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dest <span class="sc">==</span> <span class="st">&quot;BOS&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,752 x 15
##    date        hour minute   dep   arr dep_delay arr_delay carrier flight origin
##    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; 
##  1 31/01/201~     7     35   735  1220         0         4 CO         282 IAH   
##  2 31/01/201~    10     47  1047  1526        -3        -5 CO         382 IAH   
##  3 31/01/201~    13      5  1305  1746         0        -3 CO         482 IAH   
##  4 31/01/201~    19      1  1901  2332         6        -1 CO         582 IAH   
##  5 31/01/201~    15     50  1550  2012         0       -25 CO         682 IAH   
##  6 30/01/201~    10     46  1046  1518        -4        -8 CO         382 IAH   
##  7 30/01/201~    13     19  1319  1811        14        22 CO         482 IAH   
##  8 30/01/201~    19      9  1909    23        14        50 CO         582 IAH   
##  9 30/01/201~    15     53  1553  2030         3        -7 CO         682 IAH   
## 10 29/01/201~     7     40   740  1227         5        16 CO         282 IAH   
## # ... with 1,742 more rows, and 5 more variables: dest &lt;chr&gt;, plane &lt;chr&gt;,
## #   cancelled &lt;dbl&gt;, time &lt;dbl&gt;, dist &lt;dbl&gt;</code></pre>
<p>Let’s build on the previous exercise and find all flights to Boston (BOS) and select only the <code>dest</code>, <code>time</code>, <code>dist</code> columns:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="basic-operations.html#cb28-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="basic-operations.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, time, dist) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="basic-operations.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dest <span class="sc">==</span> <span class="st">&quot;BOS&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,752 x 3
##    dest   time  dist
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 BOS     195  1597
##  2 BOS     188  1597
##  3 BOS     190  1597
##  4 BOS     188  1597
##  5 BOS     180  1597
##  6 BOS     190  1597
##  7 BOS     185  1597
##  8 BOS     198  1597
##  9 BOS     194  1597
## 10 BOS     203  1597
## # ... with 1,742 more rows</code></pre>
<p>Now let’s do the filter first and then select the columns</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="basic-operations.html#cb30-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="basic-operations.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dest <span class="sc">==</span> <span class="st">&quot;BOS&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="basic-operations.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, time, dist) </span></code></pre></div>
<pre><code>## # A tibble: 1,752 x 3
##    dest   time  dist
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 BOS     195  1597
##  2 BOS     188  1597
##  3 BOS     190  1597
##  4 BOS     188  1597
##  5 BOS     180  1597
##  6 BOS     190  1597
##  7 BOS     185  1597
##  8 BOS     198  1597
##  9 BOS     194  1597
## 10 BOS     203  1597
## # ... with 1,742 more rows</code></pre>
<p>In this case the order doesn’t matter, but when using pipes make sure you understand that each function is executed in sequence and the results are then fed to the next one.</p>
<div id="exercise" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Exercise</h3>
<p>Find all flights that match the following conditions:</p>
<ol style="list-style-type: decimal">
<li>To SFO or OAK</li>
<li>In January</li>
<li>Delayed departure by more than an hour</li>
<li>Departure delay more than twice the arrival delay</li>
</ol>
<p>Here’s a brief summary of operators you can use:</p>
<p><strong>Comparison Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
<th align="left">Example (assume x is 5)</th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">&gt;</td>
<td align="left">greater than</td>
<td align="left">x &gt; 5</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">&gt;=</td>
<td align="left">greater than or equal to</td>
<td align="left">x &gt;= 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">&lt;</td>
<td align="left">less than</td>
<td align="left">x &lt; 5</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">&lt;=</td>
<td align="left">less than or equal to</td>
<td align="left">x &lt;= 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">==</td>
<td align="left">equal to</td>
<td align="left">x == 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">!=</td>
<td align="left">not equal to</td>
<td align="left">x != 5</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p><strong>Logical Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">!</td>
<td align="left">not</td>
</tr>
<tr class="even">
<td align="left">|</td>
<td align="left">or</td>
</tr>
<tr class="odd">
<td align="left">&amp;</td>
<td align="left">and</td>
</tr>
</tbody>
</table>
<p><strong>Other Operators</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="27%" />
<col width="47%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
<th align="left">Example (assume x is 5)</th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">%in%</td>
<td align="left">check element in a vector</td>
<td align="left">x %in% c(1, 3, 5, 7)<br>x %in% c(2, 4, 6, 8)</td>
<td align="left">TRUE<br>FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="arrange" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Arrange</h2>
<p>The <code>arrange()</code> function is used to sort the rows based on one or more columns</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="basic-operations.html#cb32-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="basic-operations.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dest) <span class="sc">%&gt;%</span> <span class="fu">select</span>(date,dest)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 2
##    date             dest 
##    &lt;chr&gt;            &lt;chr&gt;
##  1 31/01/2011 12:00 ABQ  
##  2 30/01/2011 12:00 ABQ  
##  3 29/01/2011 12:00 ABQ  
##  4 28/01/2011 12:00 ABQ  
##  5 27/01/2011 12:00 ABQ  
##  6 26/01/2011 12:00 ABQ  
##  7 25/01/2011 12:00 ABQ  
##  8 24/01/2011 12:00 ABQ  
##  9 23/01/2011 12:00 ABQ  
## 10 22/01/2011 12:00 ABQ  
## # ... with 227,486 more rows</code></pre>
<div id="exercise-1" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li><p>Order flights by departure date and time</p></li>
<li><p>Which flights were most delayed?</p></li>
<li><p>Which flights caught up the most time during flight?</p></li>
</ol>
</div>
</div>
<div id="mutate" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Mutate</h2>
<p>The <code>mutate()</code> function is used to create new variables.</p>
<p>Up until now we’ve only been examining the dataset but haven’t made any changes to it. All our functions so far have simply displayed the results on screen but haven’t created or modified existing variables. Let’s see how we can create a new variable called <code>speed</code> based on the distance and duration in the flights dataframe.</p>
<p>In this exercise we’re adding a new variable to an existing dataframe so we’ll just overwrite the <code>flights</code> dataframe with the one that has a <code>speed</code> column</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="basic-operations.html#cb34-1" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="basic-operations.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">speed =</span> dist <span class="sc">/</span> (time <span class="sc">/</span> <span class="dv">60</span>))</span>
<span id="cb34-3"><a href="basic-operations.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="basic-operations.html#cb34-4" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="basic-operations.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(speed)<span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="basic-operations.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(speed)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 1
##    speed
##    &lt;dbl&gt;
##  1  98.8
##  2 106. 
##  3 109. 
##  4 115. 
##  5 125. 
##  6 127. 
##  7 127. 
##  8 129. 
##  9 140  
## 10 141. 
## # ... with 227,486 more rows</code></pre>
<div id="exercise-2" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li><p>Add a variable to show how much time was made up (or lost) during flight</p></li>
<li><p>Add a variable to identify all short flights that take less than one hour</p></li>
</ol>
</div>
</div>
<div id="summarise" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Summarise</h2>
<p>Let’s count the number of flights departing each day.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="basic-operations.html#cb36-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="basic-operations.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="basic-operations.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span></code></pre></div>
<pre><code>## # A tibble: 365 x 2
##    date             count
##    &lt;chr&gt;            &lt;int&gt;
##  1 01/01/2011 12:00   552
##  2 01/02/2011 12:00   577
##  3 01/03/2011 12:00   591
##  4 01/04/2011 12:00   684
##  5 01/05/2011 12:00   619
##  6 01/06/2011 12:00   591
##  7 01/07/2011 12:00   699
##  8 01/08/2011 12:00   699
##  9 01/09/2011 12:00   670
## 10 01/10/2011 12:00   490
## # ... with 355 more rows</code></pre>
<p>Here’s a nice little trick. You can use <code>View()</code> to look at the results of a pipe operation without creating new variables.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="basic-operations.html#cb38-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="basic-operations.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="basic-operations.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="basic-operations.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">View</span>()</span></code></pre></div>
<p>Of course, often times we’d want to save the summary in a variable for further analysis.</p>
<p>Let’s find the average departure delay for each destination</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="basic-operations.html#cb39-1" aria-hidden="true" tabindex="-1"></a>delays <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="basic-operations.html#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="basic-operations.html#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">average_delay =</span> <span class="fu">mean</span>(dep_delay))</span>
<span id="cb39-4"><a href="basic-operations.html#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="basic-operations.html#cb39-5" aria-hidden="true" tabindex="-1"></a>delays</span></code></pre></div>
<pre><code>## # A tibble: 116 x 2
##    dest  average_delay
##    &lt;chr&gt;         &lt;dbl&gt;
##  1 ABQ            NA  
##  2 AEX            NA  
##  3 AGS            10  
##  4 AMA            NA  
##  5 ANC            25.0
##  6 ASE            NA  
##  7 ATL            NA  
##  8 AUS            NA  
##  9 AVL            NA  
## 10 BFL            NA  
## # ... with 106 more rows</code></pre>
<div id="exercise-3" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li><p>What’s wrong with the results above, and how would you fix the problem?</p></li>
<li><p>Can you think of using filter to solve the problem?</p></li>
<li><p>How many different destinations can you fly to from Houston?</p></li>
<li><p>Which destinations have the highest average delays?</p></li>
</ol>
</div>
</div>
<div id="unite" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Unite</h2>
<p>The <code>unite</code> function is useful for combining multiple columns together. In the example below, we join the <code>carrier</code> and <code>flight</code> to create a unique <code>flight_id</code> column.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="basic-operations.html#cb41-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="basic-operations.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(flight_id, carrier, flight, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="basic-operations.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, carrier, flight, flight_id)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 4
##    date             carrier flight flight_id
##    &lt;chr&gt;            &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;    
##  1 01/01/2011 12:00 AA         428 AA-428   
##  2 02/01/2011 12:00 AA         428 AA-428   
##  3 03/01/2011 12:00 AA         428 AA-428   
##  4 04/01/2011 12:00 AA         428 AA-428   
##  5 05/01/2011 12:00 AA         428 AA-428   
##  6 06/01/2011 12:00 AA         428 AA-428   
##  7 07/01/2011 12:00 AA         428 AA-428   
##  8 08/01/2011 12:00 AA         428 AA-428   
##  9 09/01/2011 12:00 AA         428 AA-428   
## 10 10/01/2011 12:00 AA         428 AA-428   
## # ... with 227,486 more rows</code></pre>
</div>
<div id="separate" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Separate</h2>
<p>The <code>separate</code> function works the other way around by splitting a single column into multiple columns. Let’s split the <code>date</code> column into separate <code>date</code> and <code>time</code> columns.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="basic-operations.html#cb43-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="basic-operations.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(date, <span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 227,496 x 18
##    date       time   hour minute   dep   arr dep_delay arr_delay carrier flight
##    &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1 01/01/2011 12:00    14      0  1400  1500         0       -10 AA         428
##  2 02/01/2011 12:00    14      1  1401  1501         1        -9 AA         428
##  3 03/01/2011 12:00    13     52  1352  1502        -8        -8 AA         428
##  4 04/01/2011 12:00    14      3  1403  1513         3         3 AA         428
##  5 05/01/2011 12:00    14      5  1405  1507         5        -3 AA         428
##  6 06/01/2011 12:00    13     59  1359  1503        -1        -7 AA         428
##  7 07/01/2011 12:00    13     59  1359  1509        -1        -1 AA         428
##  8 08/01/2011 12:00    13     55  1355  1454        -5       -16 AA         428
##  9 09/01/2011 12:00    14     43  1443  1554        43        44 AA         428
## 10 10/01/2011 12:00    14     43  1443  1553        43        43 AA         428
## # ... with 227,486 more rows, and 8 more variables: origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   plane &lt;chr&gt;, cancelled &lt;dbl&gt;, dist &lt;dbl&gt;, speed &lt;dbl&gt;,
## #   delay_difference &lt;dbl&gt;, short_flights &lt;lgl&gt;</code></pre>
<div id="exercise-4" class="section level3" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li><p>Split the <code>date</code> column into <code>year</code>, <code>month</code>, and <code>day</code> columns</p></li>
<li><p>Ensure that the <code>year</code>, <code>month</code>, and <code>day</code> columns are of type <em>integer</em> (NOT <em>character</em>)</p>
<ul>
<li>HINT: Use online help for <code>separate</code> for an easy way to do this</li>
</ul></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="merging-datasets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data_manipulation_with_R.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
