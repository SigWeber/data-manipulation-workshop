<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Basic Operations | Data manipulation in R</title>
  <meta name="description" content="3 Basic Operations | Data manipulation in R" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Basic Operations | Data manipulation in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Basic Operations | Data manipulation in R" />
  
  
  

<meta name="author" content="Sigrid Weber" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-started.html">
<link rel="next" href="merging-datasets.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>1</b> Resources</a></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#prerequisites"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#software-requirements"><i class="fa fa-check"></i><b>2.2</b> Software Requirements</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#required-packages"><i class="fa fa-check"></i><b>2.3</b> Required Packages</a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started.html"><a href="getting-started.html#option-1-use-tidyverse"><i class="fa fa-check"></i><b>2.3.1</b> Option 1: Use <code>tidyverse</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-started.html"><a href="getting-started.html#option-2-install-individual-packages"><i class="fa fa-check"></i><b>2.3.2</b> Option 2: Install Individual Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>3</b> Basic Operations</a><ul>
<li class="chapter" data-level="3.1" data-path="basic-operations.html"><a href="basic-operations.html#data-pipelines"><i class="fa fa-check"></i><b>3.1</b> Data pipelines</a></li>
<li class="chapter" data-level="3.2" data-path="basic-operations.html"><a href="basic-operations.html#dataset"><i class="fa fa-check"></i><b>3.2</b> Dataset</a></li>
<li class="chapter" data-level="3.3" data-path="basic-operations.html"><a href="basic-operations.html#select"><i class="fa fa-check"></i><b>3.3</b> Select</a></li>
<li class="chapter" data-level="3.4" data-path="basic-operations.html"><a href="basic-operations.html#filter"><i class="fa fa-check"></i><b>3.4</b> Filter</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise"><i class="fa fa-check"></i><b>3.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="basic-operations.html"><a href="basic-operations.html#arrange"><i class="fa fa-check"></i><b>3.5</b> Arrange</a><ul>
<li class="chapter" data-level="3.5.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-1"><i class="fa fa-check"></i><b>3.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basic-operations.html"><a href="basic-operations.html#mutate"><i class="fa fa-check"></i><b>3.6</b> Mutate</a><ul>
<li class="chapter" data-level="3.6.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-2"><i class="fa fa-check"></i><b>3.6.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="basic-operations.html"><a href="basic-operations.html#summarise"><i class="fa fa-check"></i><b>3.7</b> Summarise</a><ul>
<li class="chapter" data-level="3.7.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-3"><i class="fa fa-check"></i><b>3.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="basic-operations.html"><a href="basic-operations.html#unite"><i class="fa fa-check"></i><b>3.8</b> Unite</a></li>
<li class="chapter" data-level="3.9" data-path="basic-operations.html"><a href="basic-operations.html#separate"><i class="fa fa-check"></i><b>3.9</b> Separate</a><ul>
<li class="chapter" data-level="3.9.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-4"><i class="fa fa-check"></i><b>3.9.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="merging-datasets.html"><a href="merging-datasets.html"><i class="fa fa-check"></i><b>4</b> Merging Datasets</a><ul>
<li class="chapter" data-level="4.1" data-path="merging-datasets.html"><a href="merging-datasets.html#left-join"><i class="fa fa-check"></i><b>4.1</b> Left Join</a></li>
<li class="chapter" data-level="4.2" data-path="merging-datasets.html"><a href="merging-datasets.html#right-join"><i class="fa fa-check"></i><b>4.2</b> Right Join</a></li>
<li class="chapter" data-level="4.3" data-path="merging-datasets.html"><a href="merging-datasets.html#inner-join"><i class="fa fa-check"></i><b>4.3</b> Inner Join</a></li>
<li class="chapter" data-level="4.4" data-path="merging-datasets.html"><a href="merging-datasets.html#full-join"><i class="fa fa-check"></i><b>4.4</b> Full Join</a></li>
<li class="chapter" data-level="4.5" data-path="merging-datasets.html"><a href="merging-datasets.html#different-column-names"><i class="fa fa-check"></i><b>4.5</b> Different Column Names</a></li>
<li class="chapter" data-level="4.6" data-path="merging-datasets.html"><a href="merging-datasets.html#exercise-5"><i class="fa fa-check"></i><b>4.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i><b>5</b> Reshaping</a></li>
<li class="chapter" data-level="6" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i><b>6</b> Acknowledgments</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data manipulation in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-operations" class="section level1">
<h1><span class="header-section-number">3</span> Basic Operations</h1>
<p>Let’s start off by creating a new R script and loading <code>tidyverse</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre>
<p>Clear everything to make sure there’s nothing leftover in our environment</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre>
<div id="data-pipelines" class="section level2">
<h2><span class="header-section-number">3.1</span> Data pipelines</h2>
<p>Dplyr makes it easy to “chain” functions together using the <em>pipe</em> operator <code>%&gt;%</code>. The following diagram illustrates the general concept of pipes where data flows from one pipe to another until all the processing is completed.</p>
<p><img src="img/pipes.png" /></p>
<p>The syntax of the pipe operator <code>%&gt;%</code> might appear unusual at first, but once you get used to it you’ll start to appreciate its power and flexibility.</p>
</div>
<div id="dataset" class="section level2">
<h2><span class="header-section-number">3.2</span> Dataset</h2>
<p>We’re using a dataset of flight departures from Houston in 2011.</p>
<table>
<thead>
<tr class="header">
<th>Filename</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flights.csv</td>
<td>Flight departures from Houston in 2011</td>
</tr>
<tr class="even">
<td>weather.csv</td>
<td>Hourly weather</td>
</tr>
<tr class="odd">
<td>planes.csv</td>
<td>Metadata for planes</td>
</tr>
<tr class="even">
<td>airports.csv</td>
<td>Metadata for airports</td>
</tr>
</tbody>
</table>
<p>We’re going to use the <code>readr</code> package which provides improved functions for reading datasets from files. Instead of the usual <code>read.csv()</code> function, we’ll use the <code>read_csv()</code> function from <code>readr</code>.
<a href="https://github.com/SigWeber/data-manipulation-workshop/blob/master/data/flights.csv" class="uri">https://github.com/SigWeber/data-manipulation-workshop/blob/master/data/flights.csv</a></p>
<pre class="sourceCode r"><code class="sourceCode r">flights &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/SigWeber/data-manipulation-workshop/master/data/flights.csv&quot;</span>)
weather &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/SigWeber/data-manipulation-workshop/master/data/weather.csv&quot;</span>)
planes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/SigWeber/data-manipulation-workshop/master/data/planes.csv&quot;</span>)
airports &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/SigWeber/data-manipulation-workshop/master/data/airports.csv&quot;</span>)</code></pre>
<p>Now let’s examine the dataset</p>
<pre class="sourceCode r"><code class="sourceCode r">flights</code></pre>
<pre><code>## # A tibble: 227,496 x 14
##    date                 hour minute   dep   arr dep_delay arr_delay carrier
##    &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1 2011-01-01 12:00:00    14      0  1400  1500         0       -10 AA     
##  2 2011-01-02 12:00:00    14      1  1401  1501         1        -9 AA     
##  3 2011-01-03 12:00:00    13     52  1352  1502        -8        -8 AA     
##  4 2011-01-04 12:00:00    14      3  1403  1513         3         3 AA     
##  5 2011-01-05 12:00:00    14      5  1405  1507         5        -3 AA     
##  6 2011-01-06 12:00:00    13     59  1359  1503        -1        -7 AA     
##  7 2011-01-07 12:00:00    13     59  1359  1509        -1        -1 AA     
##  8 2011-01-08 12:00:00    13     55  1355  1454        -5       -16 AA     
##  9 2011-01-09 12:00:00    14     43  1443  1554        43        44 AA     
## 10 2011-01-10 12:00:00    14     43  1443  1553        43        43 AA     
## # ... with 227,486 more rows, and 6 more variables: flight &lt;dbl&gt;,
## #   dest &lt;chr&gt;, plane &lt;chr&gt;, cancelled &lt;dbl&gt;, time &lt;dbl&gt;, dist &lt;dbl&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">weather</code></pre>
<pre><code>## # A tibble: 8,723 x 14
##    date        hour  temp dew_point humidity pressure visibility wind_dir
##    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;   
##  1 2011-01-01     0  59        28.9       32     29.9         10 NNE     
##  2 2011-01-01     1  57.2      28.4       33     29.9         10 NNE     
##  3 2011-01-01     2  55.4      28.4       36     29.9         10 NNW     
##  4 2011-01-01     3  53.6      28.4       38     29.9         10 North   
##  5 2011-01-01     4  NA        NA         NA     30.0         10 NNW     
##  6 2011-01-01     5  NA        NA         NA     30.0         10 North   
##  7 2011-01-01     6  53.1      17.1       24     30.0         10 North   
##  8 2011-01-01     7  53.1      16         23     30.1         10 North   
##  9 2011-01-01     8  54        18         24     30.1         10 North   
## 10 2011-01-01     9  55.4      17.6       23     30.1         10 NNE     
## # ... with 8,713 more rows, and 6 more variables: wind_dir2 &lt;dbl&gt;,
## #   wind_speed &lt;dbl&gt;, gust_speed &lt;dbl&gt;, precip &lt;dbl&gt;, conditions &lt;chr&gt;,
## #   events &lt;chr&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">planes</code></pre>
<pre><code>## # A tibble: 2,853 x 9
##    plane   year mfr       model   no.eng no.seats speed engine   type      
##    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;     
##  1 N576AA  1991 MCDONNEL~ DC-9-8~      2      172    NA Turbo-f~ Fixed win~
##  2 N557AA  1993 MARZ BAR~ KITFOX~      1        2    NA Recipro~ Fixed win~
##  3 N403AA  1974 RAVEN     S55A        NA        1    60 None     Balloon   
##  4 N492AA  1989 MCDONNEL~ DC-9-8~      2      172    NA Turbo-f~ Fixed win~
##  5 N262AA  1985 MCDONNEL~ DC-9-8~      2      172    NA Turbo-f~ Fixed win~
##  6 N493AA  1989 MCDONNEL~ DC-9-8~      2      172    NA Turbo-f~ Fixed win~
##  7 N477AA  1988 MCDONNEL~ DC-9-8~      2      172    NA Turbo-f~ Fixed win~
##  8 N476AA  1988 MCDONNEL~ DC-9-8~      2      172    NA Turbo-f~ Fixed win~
##  9 N504AA    NA AUTHIER ~ TIERRA~      1        2    NA Recipro~ Fixed win~
## 10 N565AA  1987 MCDONNEL~ DC-9-8~      2      172    NA Turbo-f~ Fixed win~
## # ... with 2,843 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">airports</code></pre>
<pre><code>## # A tibble: 3,376 x 7
##    iata  airport              city             state country   lat   long
##    &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
##  1 00M   Thigpen              Bay Springs      MS    USA      32.0  -89.2
##  2 00R   Livingston Municipal Livingston       TX    USA      30.7  -95.0
##  3 00V   Meadow Lake          Colorado Springs CO    USA      38.9 -105. 
##  4 01G   Perry-Warsaw         Perry            NY    USA      42.7  -78.1
##  5 01J   Hilliard Airpark     Hilliard         FL    USA      30.7  -81.9
##  6 01M   Tishomingo County    Belmont          MS    USA      34.5  -88.2
##  7 02A   Gragg-Wade           Clanton          AL    USA      32.9  -86.6
##  8 02C   Capitol              Brookfield       WI    USA      43.1  -88.2
##  9 02G   Columbiana County    East Liverpool   OH    USA      40.7  -80.6
## 10 03D   Memphis Memorial     Memphis          MO    USA      40.4  -92.2
## # ... with 3,366 more rows</code></pre>
<p>Notice that because we used <code>read_csv()</code>, the data frame we received now prints nicely without having to use the <code>head()</code> function and does not clutter your screen.</p>
</div>
<div id="select" class="section level2">
<h2><span class="header-section-number">3.3</span> Select</h2>
<p>The <code>select</code> function is used to select columns.</p>
<ul>
<li>Select the destination, duration and distance columns (<code>dest</code>, <code>time</code> and <code>dist</code>)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dest, time, dist)</code></pre>
<pre><code>## # A tibble: 227,496 x 3
##    dest   time  dist
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 DFW      40   224
##  2 DFW      45   224
##  3 DFW      48   224
##  4 DFW      39   224
##  5 DFW      44   224
##  6 DFW      45   224
##  7 DFW      43   224
##  8 DFW      40   224
##  9 DFW      41   224
## 10 DFW      45   224
## # ... with 227,486 more rows</code></pre>
<p>Add the arrival delay (<code>arr_delay</code>) and departure delay (<code>dep_delay</code>) columns as well.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dest, time, dist, arr_delay, dep_delay)</code></pre>
<pre><code>## # A tibble: 227,496 x 5
##    dest   time  dist arr_delay dep_delay
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 DFW      40   224       -10         0
##  2 DFW      45   224        -9         1
##  3 DFW      48   224        -8        -8
##  4 DFW      39   224         3         3
##  5 DFW      44   224        -3         5
##  6 DFW      45   224        -7        -1
##  7 DFW      43   224        -1        -1
##  8 DFW      40   224       -16        -5
##  9 DFW      41   224        44        43
## 10 DFW      45   224        43        43
## # ... with 227,486 more rows</code></pre>
<p>Other ways to do the same</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dest, time, dist, <span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>))</code></pre>
<pre><code>## # A tibble: 227,496 x 5
##    dest   time  dist dep_delay arr_delay
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 DFW      40   224         0       -10
##  2 DFW      45   224         1        -9
##  3 DFW      48   224        -8        -8
##  4 DFW      39   224         3         3
##  5 DFW      44   224         5        -3
##  6 DFW      45   224        -1        -7
##  7 DFW      43   224        -1        -1
##  8 DFW      40   224        -5       -16
##  9 DFW      41   224        43        44
## 10 DFW      45   224        43        43
## # ... with 227,486 more rows</code></pre>
<p>and …</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dest, time, dist, <span class="kw">contains</span>(<span class="st">&quot;delay&quot;</span>))</code></pre>
<pre><code>## # A tibble: 227,496 x 5
##    dest   time  dist dep_delay arr_delay
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 DFW      40   224         0       -10
##  2 DFW      45   224         1        -9
##  3 DFW      48   224        -8        -8
##  4 DFW      39   224         3         3
##  5 DFW      44   224         5        -3
##  6 DFW      45   224        -1        -7
##  7 DFW      43   224        -1        -1
##  8 DFW      40   224        -5       -16
##  9 DFW      41   224        43        44
## 10 DFW      45   224        43        43
## # ... with 227,486 more rows</code></pre>
<p>Select all columns from <code>date</code> to <code>arr</code></p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(date<span class="op">:</span>arr)</code></pre>
<pre><code>## # A tibble: 227,496 x 5
##    date                 hour minute   dep   arr
##    &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2011-01-01 12:00:00    14      0  1400  1500
##  2 2011-01-02 12:00:00    14      1  1401  1501
##  3 2011-01-03 12:00:00    13     52  1352  1502
##  4 2011-01-04 12:00:00    14      3  1403  1513
##  5 2011-01-05 12:00:00    14      5  1405  1507
##  6 2011-01-06 12:00:00    13     59  1359  1503
##  7 2011-01-07 12:00:00    13     59  1359  1509
##  8 2011-01-08 12:00:00    13     55  1355  1454
##  9 2011-01-09 12:00:00    14     43  1443  1554
## 10 2011-01-10 12:00:00    14     43  1443  1553
## # ... with 227,486 more rows</code></pre>
<p>Select all <em>except</em> <code>plane</code> column using the <em>minus</em> sign</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>plane)</code></pre>
<pre><code>## # A tibble: 227,496 x 13
##    date                 hour minute   dep   arr dep_delay arr_delay carrier
##    &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1 2011-01-01 12:00:00    14      0  1400  1500         0       -10 AA     
##  2 2011-01-02 12:00:00    14      1  1401  1501         1        -9 AA     
##  3 2011-01-03 12:00:00    13     52  1352  1502        -8        -8 AA     
##  4 2011-01-04 12:00:00    14      3  1403  1513         3         3 AA     
##  5 2011-01-05 12:00:00    14      5  1405  1507         5        -3 AA     
##  6 2011-01-06 12:00:00    13     59  1359  1503        -1        -7 AA     
##  7 2011-01-07 12:00:00    13     59  1359  1509        -1        -1 AA     
##  8 2011-01-08 12:00:00    13     55  1355  1454        -5       -16 AA     
##  9 2011-01-09 12:00:00    14     43  1443  1554        43        44 AA     
## 10 2011-01-10 12:00:00    14     43  1443  1553        43        43 AA     
## # ... with 227,486 more rows, and 5 more variables: flight &lt;dbl&gt;,
## #   dest &lt;chr&gt;, cancelled &lt;dbl&gt;, time &lt;dbl&gt;, dist &lt;dbl&gt;</code></pre>
</div>
<div id="filter" class="section level2">
<h2><span class="header-section-number">3.4</span> Filter</h2>
<p>The <code>filter()</code> function returns rows with matching conditions. We can find all flights to Boston (BOS) like this:</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;BOS&quot;</span>)</code></pre>
<pre><code>## # A tibble: 1,752 x 14
##    date                 hour minute   dep   arr dep_delay arr_delay carrier
##    &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1 2011-01-31 12:00:00     7     35   735  1220         0         4 CO     
##  2 2011-01-31 12:00:00    10     47  1047  1526        -3        -5 CO     
##  3 2011-01-31 12:00:00    13      5  1305  1746         0        -3 CO     
##  4 2011-01-31 12:00:00    19      1  1901  2332         6        -1 CO     
##  5 2011-01-31 12:00:00    15     50  1550  2012         0       -25 CO     
##  6 2011-01-30 12:00:00    10     46  1046  1518        -4        -8 CO     
##  7 2011-01-30 12:00:00    13     19  1319  1811        14        22 CO     
##  8 2011-01-30 12:00:00    19      9  1909    23        14        50 CO     
##  9 2011-01-30 12:00:00    15     53  1553  2030         3        -7 CO     
## 10 2011-01-29 12:00:00     7     40   740  1227         5        16 CO     
## # ... with 1,742 more rows, and 6 more variables: flight &lt;dbl&gt;,
## #   dest &lt;chr&gt;, plane &lt;chr&gt;, cancelled &lt;dbl&gt;, time &lt;dbl&gt;, dist &lt;dbl&gt;</code></pre>
<p>Let’s build on the previous exercise and find all flights to Boston (BOS) and select only the <code>dest</code>, <code>time</code>, <code>dist</code> columns:</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dest, time, dist) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;BOS&quot;</span>)</code></pre>
<pre><code>## # A tibble: 1,752 x 3
##    dest   time  dist
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 BOS     195  1597
##  2 BOS     188  1597
##  3 BOS     190  1597
##  4 BOS     188  1597
##  5 BOS     180  1597
##  6 BOS     190  1597
##  7 BOS     185  1597
##  8 BOS     198  1597
##  9 BOS     194  1597
## 10 BOS     203  1597
## # ... with 1,742 more rows</code></pre>
<p>Now let’s do the filter first and then select the columns</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;BOS&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dest, time, dist) </code></pre>
<pre><code>## # A tibble: 1,752 x 3
##    dest   time  dist
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 BOS     195  1597
##  2 BOS     188  1597
##  3 BOS     190  1597
##  4 BOS     188  1597
##  5 BOS     180  1597
##  6 BOS     190  1597
##  7 BOS     185  1597
##  8 BOS     198  1597
##  9 BOS     194  1597
## 10 BOS     203  1597
## # ... with 1,742 more rows</code></pre>
<p>In this case the order doesn’t matter, but when using pipes make sure you understand that each function is executed in sequence and the results are then fed to the next one.</p>
<div id="exercise" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Exercise</h3>
<p>Find all flights that match the following conditions:</p>
<ol style="list-style-type: decimal">
<li>To SFO or OAK</li>
<li>In January</li>
<li>Delayed by more than an hour</li>
<li>Departed between midnight and 5am</li>
<li>Arrival delay more than twice the departure delay</li>
</ol>
<p>Here’s a brief summary of operators you can use:</p>
<p><strong>Comparison Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
<th align="left">Example (assume x is 5)</th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">&gt;</td>
<td align="left">greater than</td>
<td align="left">x &gt; 5</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">&gt;=</td>
<td align="left">greater than or equal to</td>
<td align="left">x &gt;= 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">&lt;</td>
<td align="left">less than</td>
<td align="left">x &lt; 5</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">&lt;=</td>
<td align="left">less than or equal to</td>
<td align="left">x &lt;= 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">==</td>
<td align="left">equal to</td>
<td align="left">x == 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">!=</td>
<td align="left">not equal to</td>
<td align="left">x != 5</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p><strong>Logical Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">!</td>
<td align="left">not</td>
</tr>
<tr class="even">
<td align="left">|</td>
<td align="left">or</td>
</tr>
<tr class="odd">
<td align="left">&amp;</td>
<td align="left">and</td>
</tr>
</tbody>
</table>
<p><strong>Other Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
<th align="left">Example (assume x is 5)</th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">%in%</td>
<td align="left">check element in a vector</td>
<td align="left">x %in% c(1, 3, 5, 7)<br>x %in% c(2, 4, 6, 8)</td>
<td align="left">TRUE<br>FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="arrange" class="section level2">
<h2><span class="header-section-number">3.5</span> Arrange</h2>
<p>The <code>arrange()</code> function is used to sort the rows based on one or more columns</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(dest)</code></pre>
<pre><code>## # A tibble: 227,496 x 14
##    date                 hour minute   dep   arr dep_delay arr_delay carrier
##    &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1 2011-01-31 12:00:00    17     33  1733  1901        -2        -4 CO     
##  2 2011-01-30 12:00:00    17     50  1750  1913        15         8 CO     
##  3 2011-01-29 12:00:00    17     32  1732  1837        -3       -23 CO     
##  4 2011-01-28 12:00:00    17     33  1733  1848        -2       -17 CO     
##  5 2011-01-27 12:00:00    17     41  1741  1854         6       -11 CO     
##  6 2011-01-26 12:00:00    17     32  1732  1853        -3       -12 CO     
##  7 2011-01-25 12:00:00    17     29  1729  1858        -6        -7 CO     
##  8 2011-01-24 12:00:00    17     34  1734  1845        -1       -20 CO     
##  9 2011-01-23 12:00:00    17     35  1735  1853         0       -12 CO     
## 10 2011-01-22 12:00:00    17     33  1733  1843        -2       -17 CO     
## # ... with 227,486 more rows, and 6 more variables: flight &lt;dbl&gt;,
## #   dest &lt;chr&gt;, plane &lt;chr&gt;, cancelled &lt;dbl&gt;, time &lt;dbl&gt;, dist &lt;dbl&gt;</code></pre>
<div id="exercise-1" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>Order flights by departure date and time</li>
<li>Which flights were most delayed?</li>
<li>Which flights caught up the most time during flight?</li>
</ol>
</div>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">3.6</span> Mutate</h2>
<p>The <code>mutate()</code> function is used to create new variables.</p>
<p>Up until now we’ve only been examining the dataset but haven’t made any changes to it. All our functions so far have simply displayed the results on screen but haven’t created or modified existing variables. Let’s see how we can create a new variable called <code>speed</code> based on the distance and duration in the flights dataframe.</p>
<p>In this exercise we’re adding a new variable to an existing dataframe so we’ll just overwrite the <code>flights</code> variable with the one that has a <code>speed</code> column</p>
<pre class="sourceCode r"><code class="sourceCode r">flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">speed =</span> dist <span class="op">/</span><span class="st"> </span>(time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>))</code></pre>
<div id="exercise-2" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>Add a variable to show how much time was made up (or lost) during flight</li>
</ol>
</div>
</div>
<div id="summarise" class="section level2">
<h2><span class="header-section-number">3.7</span> Summarise</h2>
<p>Let’s count the number of flights departing each day.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) </code></pre>
<pre><code>## # A tibble: 365 x 2
##    date                count
##    &lt;dttm&gt;              &lt;int&gt;
##  1 2011-01-01 12:00:00   552
##  2 2011-01-02 12:00:00   678
##  3 2011-01-03 12:00:00   702
##  4 2011-01-04 12:00:00   583
##  5 2011-01-05 12:00:00   590
##  6 2011-01-06 12:00:00   660
##  7 2011-01-07 12:00:00   661
##  8 2011-01-08 12:00:00   500
##  9 2011-01-09 12:00:00   602
## 10 2011-01-10 12:00:00   659
## # ... with 355 more rows</code></pre>
<p>Here’s a nice little trick. You can use <code>View()</code> to look at the results of a pipe operation without creating new variables.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">View</span>()</code></pre>
<p>Of course, often times we’d want to save the summary in a variable for further analysis.</p>
<p>Let’s find the average departure delay for each destination</p>
<pre class="sourceCode r"><code class="sourceCode r">delays &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(dep_delay))

delays</code></pre>
<pre><code>## # A tibble: 116 x 2
##    dest   mean
##    &lt;chr&gt; &lt;dbl&gt;
##  1 ABQ    NA  
##  2 AEX    NA  
##  3 AGS    10  
##  4 AMA    NA  
##  5 ANC    25.0
##  6 ASE    NA  
##  7 ATL    NA  
##  8 AUS    NA  
##  9 AVL    NA  
## 10 BFL    NA  
## # ... with 106 more rows</code></pre>
<div id="exercise-3" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>What’s wrong with the results above, and how would you fix the problem?</li>
<li>Can you think of using filter to solve the problem?</li>
<li>Use help to find out two other ways to do summarize/n combination in dplyr.</li>
<li>How many different destinations can you fly to from Houston?</li>
<li>Which destinations have the highest average delays?</li>
<li>Which flights (carrier + flight number) happen everyday and where do they fly?</li>
<li>How do delays (of non-cancelled flights) vary over the course of a day?</li>
</ol>
</div>
</div>
<div id="unite" class="section level2">
<h2><span class="header-section-number">3.8</span> Unite</h2>
<p>The <code>unite</code> function is useful for combining multiple columns together. In the example below, we join the <code>carrier</code> and <code>flight</code> to create a unique <code>flight_id</code> column.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">unite</span>(flight_id, carrier, flight, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(date, carrier, flight, flight_id)</code></pre>
<pre><code>## # A tibble: 227,496 x 4
##    date                carrier flight flight_id
##    &lt;dttm&gt;              &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;    
##  1 2011-01-01 12:00:00 AA         428 AA-428   
##  2 2011-01-02 12:00:00 AA         428 AA-428   
##  3 2011-01-03 12:00:00 AA         428 AA-428   
##  4 2011-01-04 12:00:00 AA         428 AA-428   
##  5 2011-01-05 12:00:00 AA         428 AA-428   
##  6 2011-01-06 12:00:00 AA         428 AA-428   
##  7 2011-01-07 12:00:00 AA         428 AA-428   
##  8 2011-01-08 12:00:00 AA         428 AA-428   
##  9 2011-01-09 12:00:00 AA         428 AA-428   
## 10 2011-01-10 12:00:00 AA         428 AA-428   
## # ... with 227,486 more rows</code></pre>
</div>
<div id="separate" class="section level2">
<h2><span class="header-section-number">3.9</span> Separate</h2>
<p>The <code>separate</code> function works the other way around by splitting a single column into multiple columns. Let’s split the <code>date</code> column into separate <code>date</code> and <code>time</code> columns.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(date, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</code></pre>
<pre><code>## # A tibble: 227,496 x 15
##    date  time   hour minute   dep   arr dep_delay arr_delay carrier flight
##    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1 2011~ 12:0~    14      0  1400  1500         0       -10 AA         428
##  2 2011~ 12:0~    14      1  1401  1501         1        -9 AA         428
##  3 2011~ 12:0~    13     52  1352  1502        -8        -8 AA         428
##  4 2011~ 12:0~    14      3  1403  1513         3         3 AA         428
##  5 2011~ 12:0~    14      5  1405  1507         5        -3 AA         428
##  6 2011~ 12:0~    13     59  1359  1503        -1        -7 AA         428
##  7 2011~ 12:0~    13     59  1359  1509        -1        -1 AA         428
##  8 2011~ 12:0~    13     55  1355  1454        -5       -16 AA         428
##  9 2011~ 12:0~    14     43  1443  1554        43        44 AA         428
## 10 2011~ 12:0~    14     43  1443  1553        43        43 AA         428
## # ... with 227,486 more rows, and 5 more variables: dest &lt;chr&gt;,
## #   plane &lt;chr&gt;, cancelled &lt;dbl&gt;, dist &lt;dbl&gt;, speed &lt;dbl&gt;</code></pre>
<div id="exercise-4" class="section level3">
<h3><span class="header-section-number">3.9.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>Split the <code>date</code> column into <code>year</code>, <code>month</code>, and <code>day</code> columns</li>
<li>Ensure that the <code>year</code>, <code>month</code>, and <code>day</code> columns are of type <em>integer</em> (NOT <em>character</em>)
<ul>
<li>HINT: Use online help for <code>separate</code> for an easy way to do this</li>
</ul></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="merging-datasets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["data_manipulation_with_R.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
